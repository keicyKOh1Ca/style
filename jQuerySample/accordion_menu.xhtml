<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <title>jQuerySample</title>
        <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
        <h:outputStylesheet name="acc_menu.css" library="css" />
        <script>
            $(function() {
                $('.acc-menu').click(function() {
                    var menu_id = $(this).attr('id');
                    $(this).siblings('ul').slideToggle('slow', function() {
                        // 表示のON-OFFをセッションストレージに格納
                        sessionStorage.setItem(menu_id , $(this).css('display'));
                    });
                });

                $('.linkCliker').on('click', function() {
                    sessionStorage.setItem('clicker' , $(this).attr('id'));
                });

                for (var i = 1; i &lt;= $(".acc-menu").length; i++) {
                    if (sessionStorage.getItem('menu' + i) == 'block') {
                        $('#menu' + i).siblings('ul').slideToggle('slow' , function() {
                            var id = sessionStorage.getItem('clicker');
                            $("#" + id).css('background-color','greenyellow');
                        });
                    }
                }
            });
        </script>
    </h:head>
    <h:body>
        <h2>アコーディオンメニューサンプル</h2>
        <h:form id="form1">
            <div class="menu">
                <div class="menu-item">
                    <div class="acc-menu" id="menu1">menu-1</div>
                    <ul>
                        <li class="linkCliker" id="link1"><h:commandLink value="transition-01" action="#{bean.next()}" /></li>
                        <li class="linkCliker" id="link2"><h:commandLink value="transition-02" action="#{bean.next()}" /></li>
                        <li class="linkCliker" id="link3"><h:commandLink value="transition-03" action="#{bean.next()}" /></li>
                    </ul>
                </div>
                <div class="menu-item">
                    <div class="acc-menu" id="menu2">menu-2</div>
                    <ul>
                        <li class="linkCliker" id="link4"><h:commandLink value="transition-04" action="#{bean.next()}" /></li>
                    </ul>
                </div>
                <div class="menu-item">
                    <div class="acc-menu" id="menu3">menu-3</div>
                    <ul>
                        <li class="linkCliker" id="link5"><h:commandLink value="transition-05" action="#{bean.next()}" /></li>
                    </ul>
                </div>
            </div>
        </h:form>
    </h:body>
</html>
